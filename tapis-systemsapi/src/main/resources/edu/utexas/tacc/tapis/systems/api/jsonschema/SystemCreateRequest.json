{
  "$id": "http://tapis.tacc.utexas.edu/SystemCreateRequest",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Schema for a system create request",
  "additionalProperties": false,

  "type": "object",
  "properties": {
    "tSystem": {
      "type": "object",
      "properties": {
        "name": { "$ref": "#/definitions/systemName" },
        "description": { "type": "string", "maxLength": 2048 },
        "systemType": { "$ref": "#/definitions/systemTypeEnum" },
        "owner": { "$ref": "#/definitions/userName" },
        "host": { "$ref": "#/definitions/hostName" },
        "enabled": { "type": "boolean", "default": true },
        "effectiveUserId": { "$ref": "#/definitions/userName" },
        "defaultAccessMethod": { "$ref": "#/definitions/accessMethodEnum" },
        "accessCredential": {"$ref": "#/definitions/credential" },
        "bucketName": { "type": "string", "maxLength": 63 },
        "rootDir": { "$ref": "#/definitions/dirPath" },
        "transferMethods": {
          "type": "array",
          "items": { "type": "string", "enum": ["SFTP","S3"] }
        },
        "port": { "type": "integer" },
        "useProxy": { "type": "boolean", "default": false },
        "proxyHost": { "$ref": "#/definitions/hostName" },
        "proxyPort": { "type": "integer" },
        "jobCanExec": { "type": "boolean" },
        "jobLocalWorkingDir": { "$ref": "#/definitions/dirPath" },
        "jobLocalArchiveDir": { "$ref": "#/definitions/dirPath" },
        "jobRemoteArchiveSystem": { "$ref": "#/definitions/systemName" },
        "jobRemoteArchiveDir": { "$ref": "#/definitions/dirPath" },
        "jobCapabilities": {
          "type": "array",
          "items": {"$ref": "#/definitions/capability" }
        },
        "tags": {
          "type": "array",
          "items": { "type":  "string", "minLength": 1, "maxLength": 256 }
        },
        "notes": { "type": "object" }
      },
      "required": [
        "name",
        "systemType",
        "host",
        "defaultAccessMethod",
        "jobCanExec"
      ]
    }
  },
  "required": [
    "tSystem"
  ],

  "definitions": {
    "systemName": { "type": "string", "minLength": 1, "maxLength": 256 },
    "hostName": { "type": "string", "minLength": 1, "maxLength": 256 },
    "userName": { "type": "string", "minLength": 1, "maxLength": 60 },
    "dirPath": { "type": "string", "minLength": 1, "maxLength": 1024 },
    "systemTypeEnum": { "type": "string", "enum": ["LINUX","OBJECT_STORE"] },
    "accessMethodEnum": { "type": "string", "enum": ["PASSWORD","PKI_KEYS","ACCESS_KEY","CERT"] },
    "credential": {
      "type": "object",
      "properties": {
        "password": { "type":  "string" },
        "privateKey": { "type":  "string" },
        "publicKey": { "type":  "string" },
        "certificate": { "type":  "string" },
        "accessKey": { "type":  "string" },
        "accessSecret": { "type":  "string" }
      }
    },
    "capabilityCategoryEnum": { "type": "string", "enum": ["SCHEDULER", "OS", "HARDWARE", "SOFTWARE", "JOB", "CONTAINER", "MISC", "CUSTOM"] },
    "capability": {
      "type": "object",
      "properties": {
        "category": { "$ref": "#/definitions/capabilityCategoryEnum" },
        "name": { "type": "string", "minLength": 1, "maxLength": 256 },
        "value": { "type": "string", "maxLength": 256 }
      },
      "required": [ "category", "name" ]
    }
  }
}
